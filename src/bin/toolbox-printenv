#!/bin/sh
# Show environment variables from the target container's main process

# Try direct read (may require additional capabilities)
if tr '\0' '\n' < /proc/1/environ 2>/dev/null | sort; then
    exit 0
else
    echo ""
    echo "âœ— Failed to read /proc/1/environ - Permission denied"
    echo ""
    echo "This requires root privileges and --share-processes flag."
    echo "The container must run as root (UID 0) to access target process environment."
    echo ""
    echo "Alternative approaches:"
    echo ""
    echo "  1. Query directly via kubectl:"
    echo "     kubectl exec <pod> -c <container> -- printenv"
    echo ""
    echo "  2. Check if filesystem access works:"
    echo "     strings /proc/1/root/proc/1/environ | sort"
    echo ""
    exit 1
fi
